"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[8182],{1033:(e,t,s)=>{var r;s.d(t,{H:()=>r}),function(e){e.Online="online",e.Offline="offline"}(r||(r={}))},9718:(e,t,s)=>{s.d(t,{a:()=>r});s(10568),s(81045),s(30163),s(45950);const r=(e,t)=>{var s,r;if(!t)return{productId:null,xboxTitleId:null};const o=(null!==(s=null===(r=e.multiplayerSummary)||void 0===r||null===(r=r.joinableActivities)||void 0===r?void 0:r.filter((t=>{switch(t.joinRestriction){case"Public":return!0;case"Followed":return e.isFriend;default:return!1}})))&&void 0!==s?s:[]).find((e=>null!=t[e.titleId.toString()]));return{productId:o?t[o.titleId.toString()]:null,xboxTitleId:o?o.titleId.toString():null}}},13312:(e,t,s)=>{s.d(t,{R:()=>o});s(10568),s(81045),s(5350),s(73118),s(90374),s(72252),s(38124),s(70889),s(98788),s(46826),s(65949),s(9402),s(84035),s(14419),s(20629),s(90029),s(21019),s(65478),s(55976),s(47010);var r=s(14041);const o=e=>(0,r.useMemo)((()=>{const t=new Set;return(null!==e&&void 0!==e?e:[]).forEach((e=>{var s,r;(null!==(s=null===(r=e.multiplayerSummary)||void 0===r?void 0:r.joinableActivities)&&void 0!==s?s:[]).forEach((e=>{t.add(e.titleId.toString())}))})),Array.from(t)}),[e])},14154:(e,t,s)=>{s.d(t,{X:()=>o});var r=s(14041);function o(e){const t=(0,r.useRef)(!1),s=(0,r.useRef)(null);return t.current||(s.current=e(),t.current=!0),s}},20418:(e,t,s)=>{s.d(t,{Ie:()=>i,Qd:()=>a});var r=s(31085),o=s(14041),n=s(79824);const i=function(){const e=(0,o.createContext)({});return e.displayName="XboxSocialClient",e}();function a(e,t){const s=(0,o.createContext)({});return s.displayName="XboxSocialClientRedux",function({children:o,context:a}){const l=(null!==a&&void 0!==a?a:i).Provider;return(0,r.jsx)(n.Provider,{context:s,store:e.getStore(),serverState:t,children:(0,r.jsx)(l,{value:{client:e,useDispatch:(0,n.createDispatchHook)(s),useSelector:(0,n.createSelectorHook)(s),useStore:(0,n.createStoreHook)(s)},children:o})})}}},24013:(e,t,s)=>{s.d(t,{H:()=>v,I:()=>d});var r=s(41506),o=s.n(r),n=(s(81045),s(42042),s(30163),s(84915),s(47010),s(57361)),i=s(14041),a=s(79094),l=s(45658),u=s(83659),c=s(56136);function d(e,t=c._.Basic){const s=(0,i.useCallback)((t=>e.map((e=>(0,u.lL)(t,e)))),[e]);return(0,n.useMultipleReduxLces)(s,(0,l.R)(e,t,"productId"),{skipErrors:!0},(e=>{if((0,n.isExpiredOrNotFetched)(e))return!0;if(t===c._.Basic)return!1;if(!(0,n.isContent)(e))return!1;return!e.data.every((e=>t===(null===e||void 0===e?void 0:e.detailLevel)))}))}function v(e,t=c._.Basic){const[s,r]=(0,a.$)(e,t),l=d((0,i.useMemo)((()=>s?Object.values(s).filter((e=>!!e)):[]),[s]),t),u=(0,i.useMemo)((()=>[void 0,o()(o()({},(0,n.lceNotRequested)()),{},{loading:!1})]),[]);return s?l:(0,n.isError)(r)||r.loading?[void 0,r]:u}},26341:(e,t,s)=>{s.d(t,{zn:()=>Dt,SI:()=>Ut,Kt:()=>Ot,aM:()=>At,Kq:()=>Nt,zE:()=>Gt,fl:()=>jt,Rd:()=>Mt,T6:()=>Ct,gw:()=>mt,R5:()=>gt,X1:()=>vt,b0:()=>bt,$R:()=>st,xR:()=>dt,l_:()=>pt,gL:()=>Lt,yo:()=>Jt,FK:()=>Rt,O3:()=>Ht,l:()=>It,Vy:()=>wt,$M:()=>_t,ac:()=>Pt,vd:()=>Bt,mm:()=>yt,qG:()=>Xt,uO:()=>ot,OC:()=>rt,dd:()=>et,rl:()=>Ze,xu:()=>kt,hk:()=>Et,Ny:()=>Tt,MK:()=>ft,Q3:()=>St,HQ:()=>it,qE:()=>Wt,eQ:()=>xt,n2:()=>qt,VR:()=>Qt,Ud:()=>nt,ZE:()=>ht,gg:()=>$t,z1:()=>ut,vH:()=>at,sj:()=>ct,JP:()=>lt,rv:()=>Ft,LV:()=>tt});s(10865),s(47010);var r=s(66957),o=s(14041),n=s(84777),i=s(19183),a=s(69617),l=s(72841),u=s(84719);const c=new r.Logger("useAcceptFriendRequest"),d=e=>(t,s,r,d)=>{const{useDispatch:v}=(0,o.useContext)(e),p=v(),g=(0,u.n)("people",e),m=(0,u.n)("trust",e),f=(0,a.Jd)(),S=null===f||void 0===f?void 0:f.xuid,[h]=(0,l.zY)(),C=(0,o.useCallback)((async e=>{if(g&&t&&S)try{c.info(`ramah - accepting friend request from xuid ${t}`),await g.socialService.acceptFriendRequest(S,t,e),p(g.actions.acceptFriendRequestSucceeded(t,s)),p(g.actions.getPerson.start(S,!0)),null===r||void 0===r||r()}catch(o){const e=g.customPeopleActions.acceptFriendRequestFailed();if(o instanceof g.socialServiceError)if(m&&o.code===g.socialServiceErrorCode.ParentalControlCheckFailed&&h)try{p(m.actions.displayAddFriendModal(S,t,n.p.Accept))}catch(i){p(e)}else o.code===g.socialServiceErrorCode.PeopleListFull||o.code===g.socialServiceErrorCode.FriendsModifyErrorListFull||o.code===g.socialServiceErrorCode.FriendsModifyErrorOtherListFull?p(g.customPeopleActions.maxFriendCountReached()):p(e);else p(e);null===d||void 0===d||d()}}),[g,t,S,p,s,r,d,m,h]);return(0,i.I)(C,!!g&&!!t&&!!S)};var v=s(57361),p=s(67814);const g=new r.Logger("useActiveLinkTokens"),m=e=>()=>{const t=(0,u.n)("people",e),[s,r]=(0,o.useState)(v.LCE_NOT_REQUESTED),n=(0,o.useCallback)((()=>{t&&(r((0,v.lceFetching)()),t.fetchActiveOpenEndedInviteLinks().then((e=>{r((0,v.lceContent)(e))})).catch((e=>{const t=(0,p.g)(e);g.error("An unexpected error occurred when trying fetch existing link tokens",t),r((0,v.lceError)(t))})))}),[t]),i=(0,o.useCallback)((()=>{r(v.LCE_NOT_REQUESTED)}),[]),a=(0,v.useLce)(s);return(0,o.useMemo)((()=>[...a,{getActiveLinkTokens:n,clearActiveLinkTokens:i}]),[a,n,i])},f=new r.Logger("useBatchAcceptFriendRequests"),S=e=>(t,s)=>{const{useDispatch:r}=(0,o.useContext)(e),n=r(),a=(0,u.n)("people",e),l=(0,o.useCallback)((async()=>{if(a)try{f.info(`ramah - accept all friend requests from xuids ${t}`);const e=await a.socialService.batchAcceptFriendRequests(t);e.updatedXuids&&e.updatedXuids.length>0&&(n(a.actions.acceptFriendRequestsSucceeded(e.updatedXuids,!1)),null===s||void 0===s||s(e.updatedXuids)),e.failedToUpdateXuids&&e.failedToUpdateXuids.length>0&&n(a.customPeopleActions.batchAcceptFriendRequestsFailed())}catch(e){n(a.customPeopleActions.batchAcceptFriendRequestsFailed())}}),[n,s,a,t]);return(0,i.I)(l,!!a)},h=new r.Logger("useBatchCancelFriendRequests"),C=e=>(t,s)=>{const{useDispatch:r}=(0,o.useContext)(e),n=r(),a=(0,u.n)("people",e),l=(0,o.useCallback)((async()=>{if(a)try{h.info(`ramah - cancel all friend requests from xuids ${t}`);const e=await a.socialService.batchCancelFriendRequests(t);e.updatedXuids&&e.updatedXuids.length>0&&(n(a.actions.cancelFriendRequestsSucceeded(e.updatedXuids,!1)),null===s||void 0===s||s(e.updatedXuids)),e.failedToUpdateXuids&&e.failedToUpdateXuids.length>0&&n(a.customPeopleActions.batchCancelFriendRequestsFailed())}catch(e){n(a.customPeopleActions.batchCancelFriendRequestsFailed())}}),[n,s,a,t]);return(0,i.I)(l,!!a)},E=new r.Logger("useBatchDeclineFriendRequests"),F=e=>(t,s)=>{const{useDispatch:r}=(0,o.useContext)(e),n=r(),a=(0,u.n)("people",e),l=(0,o.useCallback)((async()=>{if(a)try{E.info(`ramah - decline all friend requests from xuids ${t}`);const e=await a.socialService.batchDeclineFriendRequests(t);e.updatedXuids&&e.updatedXuids.length>0&&(n(a.actions.declineFriendRequestsSucceeded(e.updatedXuids,!1)),null===s||void 0===s||s(e.updatedXuids)),e.failedToUpdateXuids&&e.failedToUpdateXuids.length>0&&n(a.customPeopleActions.batchDeclineFriendRequestsFailed())}catch(e){n(a.customPeopleActions.batchDeclineFriendRequestsFailed())}}),[n,s,a,t]);return(0,i.I)(l,!!a)},k=new r.Logger("useCancelFriendRequest"),y=e=>(t,s,r,n)=>{const{useDispatch:l}=(0,o.useContext)(e),c=l(),d=(0,u.n)("people",e),v=(0,a.Jd)(),p=null===v||void 0===v?void 0:v.xuid,g=(0,o.useCallback)((async()=>{if(d&&t&&p)try{k.info(`ramah - canceling friend request to xuid ${t}`),await d.socialService.cancelFriendRequest(p,t),c(d.actions.cancelFriendRequestSucceeded(t,s)),null===n||void 0===n||n()}catch(e){c(d.customPeopleActions.cancelFriendRequestFailed())}finally{null===r||void 0===r||r()}}),[d,t,p,c,s,n,r]);return(0,i.I)(g,!!d&&!!t&&!!p)},R=e=>(t,s,n,i)=>{const a=(0,u.n)("people",e),l=(0,r.useLogger)("useCommitNewGamertag"),[c,d]=(0,o.useState)(v.LCE_NOT_REQUESTED);return(0,o.useEffect)((()=>{a&&(d((0,v.lceFetching)()),null===a||void 0===a||a.gamertagService.commitGamertagChange(t,s,n,i).then((()=>{d((0,v.lceContent)(!0))})).catch((e=>{const t=(0,p.g)(e);d((0,v.lceError)(t)),l.error(`Failed to commit and change the new gamertag(s):  ${t}`)})))}),[a,n,i,l,t,s]),(0,v.useLce)(c)},L=new r.Logger("useDeclineFriendRequest"),U=e=>(t,s,r,n)=>{const{useDispatch:l}=(0,o.useContext)(e),c=l(),d=(0,u.n)("people",e),v=(0,a.Jd)(),p=null===v||void 0===v?void 0:v.xuid,g=(0,o.useCallback)((async()=>{if(d&&t&&p)try{L.info(`ramah - declining request from xuid ${t}`),await d.socialService.declineFriendRequest(p,t),c(d.actions.declineFriendRequestSucceeded(t,s)),null===r||void 0===r||r()}catch(e){c(d.customPeopleActions.declineFriendRequestFailed()),null===n||void 0===n||n()}}),[d,t,p,c,s,r,n]);return(0,i.I)(g,!!d&&!!t&&!!p)};s(81045),s(45950);var x=s(12885);const T=new r.Logger("useFindJoinableSessionFromXuid"),b=e=>(t,s)=>{const r=(0,u.n)("people",e),[n,i]=(0,o.useState)(v.LCE_NOT_REQUESTED);return(0,o.useEffect)((()=>{r&&t&&s&&(i((0,v.lceFetching)()),r.multiplayerService.getActivitiesForXuidsAsync([t]).then((e=>{const r=e[t].find((e=>e.titleId===s));i((0,v.lceContent)(r||null))})).catch((e=>{const t=(0,x.toError)(e);T.error("Failed to fetch joinable session",t),i((0,v.lceError)(t))})))}),[r,s,t]),(0,v.useLce)(n)};var w=s(34721);s(33975);const _=(e,t)=>e.sort(((e,s)=>{if(e.xuid===t)return-1;if(s.xuid===t)return 1;if(e.isFriend&&s.isFriend){if(e.isFavorite&&!s.isFavorite)return-1;if(!e.isFavorite&&s.isFavorite)return 1}return e.isFriend&&!s.isFriend?-1:!e.isFriend&&s.isFriend?1:e.gamertag.uniqueGamertag.localeCompare(s.gamertag.uniqueGamertag)})),I=e=>()=>{const{useSelector:t,useDispatch:s,useStore:r}=(0,o.useContext)(e),n=(0,u.n)("people",e),i=null===n||void 0===n?void 0:n.peopleSelectors,a=null===n||void 0===n?void 0:n.actions,l=(0,o.useCallback)((e=>i?i.getFollowersLCE(e,n.decoration.Presence):v.LCE_NOT_REQUESTED),[n,i]),c=(0,o.useMemo)((()=>null===a||void 0===a?void 0:a.getFollowers.start(["presenceDetail"])),[a]),d=s(),p=(0,o.useCallback)((()=>{c&&d(c)}),[d,c]),[,g]=(0,w.r)(n,l,c,void 0,{useSelector:t,useDispatch:s,useStore:r}),m=(0,o.useMemo)((()=>(0,v.lceTransform)(g,(e=>_(e)))),[g]);return(0,v.useLce)(m,p)},P=(0,v.lceFetching)(),D=e=>(t,s)=>{const{useSelector:r,useDispatch:n,useStore:i}=(0,o.useContext)(e),l=(0,a.XI)(),c=(0,u.n)("people",e),d=(0,o.useMemo)((()=>{const e=["Presence","Detail","MultiplayerSummary"],t=s?[...e,...s]:e;let r=0;if(c)for(const s of t)switch(s){case"Presence":r|=c.decoration.Presence;break;case"PreferredColors":r|=c.decoration.PreferredColors;break;case"Detail":r|=null===c||void 0===c?void 0:c.decoration.Detail;break;case"Recommendation":r|=c.decoration.Recommendation;break;case"MultiplayerSummary":r|=c.decoration.MultiplayerSummary;break;case"RecentPlayer":r|=c.decoration.RecentPlayer}return r}),[s,c]),p=null===c||void 0===c?void 0:c.peopleSelectors,{getProfiles:g}=(0,o.useMemo)((()=>t?p?p.makeGroupSelectors(t):{getProfiles:()=>Array(t.length).fill(P)}:{getProfiles:()=>[v.LCE_NOT_REQUESTED]}),[t,p]),m=(0,o.useMemo)((()=>t&&c&&l?c.actions.getPeople.start(t):void 0),[t,c,l]);return(0,w.y)(c,(e=>g(e,d)),m,{skipErrors:!0},void 0,{useSelector:r,useDispatch:n,useStore:i})},M=e=>{const t=D(e);return s=>{const{useSelector:r,useDispatch:n,useStore:i}=(0,o.useContext)(e),l=(0,u.n)("people",e),c=null===l||void 0===l?void 0:l.peopleSelectors,d=null===l||void 0===l?void 0:l.actions,p=(0,a.Jd)(),g=null===p||void 0===p?void 0:p.xuid,m=(0,o.useCallback)((e=>c&&s?c.getFollowedByUserXuidsLCE(e,s):v.LCE_NOT_REQUESTED),[c,s]),f=(0,o.useMemo)((()=>s?null===d||void 0===d?void 0:d.getFollowedByUser.start(s):void 0),[d,s]),S=n(),h=(0,o.useCallback)((()=>{f&&S(f)}),[S,f]),[C,E]=(0,w.r)(l,m,f,void 0,{useSelector:r,useDispatch:n,useStore:i}),[,F]=t(C),k=(0,o.useMemo)((()=>(0,v.lceTransform)((0,v.lceMerge)(E,F,{onlyRequireOneNotRequested:!0}),(([e,t])=>e&&t?_(t,g):[]))),[g,E,F]);return(0,v.useLce)(k,h)}},G=e=>function(t){const{useDispatch:s}=(0,o.useContext)(e),r=(0,u.n)("people",e),n=(0,u.n)("trust",e),c=s(),d=(0,a.Jd)(),v=null===d||void 0===d?void 0:d.xuid,[p]=(0,l.zY)(),[g]=Ze(t),m=(0,o.useCallback)((async()=>{if(r&&v)if(g&&g.detail&&!g.detail.canBeFollowed)c(r.customPeopleActions.allowFollowersBlocked());else try{await r.socialService.followUser(v,t),c(r.actions.followUserSucceeded(t)),c(r.actions.getPerson.start(v,!0))}catch(e){const o=r.customPeopleActions.followUserFailed(v,t);if(e instanceof r.socialServiceError)if(n&&e.code===r.socialServiceErrorCode.ParentalControlCheckFailed&&p)try{c(n.actions.displayFollowUserModal(v,t))}catch(s){c(o)}else e.code===r.socialServiceErrorCode.FriendRequestPrivacyFail?c(r.customPeopleActions.allowFollowersBlocked()):e.code!==r.socialServiceErrorCode.PeopleListFull&&e.code!==r.socialServiceErrorCode.FriendsModifyErrorListFull&&e.code!==r.socialServiceErrorCode.FriendsModifyErrorOtherListFull||c(r.customPeopleActions.maxFollowingCountReached());else c(o)}}),[r,v,g,c,t,n,p]);return(0,i.I)(m,!!r&&!!v)};s(97107);const q=e=>t=>{const s=(0,u.n)("people",e),[r,n]=(0,o.useState)((0,v.lceFetching)());return(0,o.useEffect)((()=>{s&&t&&s.socialService.getFriendLinkPreview(t).then((e=>{n(e?(0,v.lceContent)(e):(0,v.lceError)(new Error("getFriendLinkPreview request was successful but a friend link wasn't returned")))})).catch((e=>{const t=(0,p.g)(e);n((0,v.lceError)(t))}))}),[t,s]),(0,v.useLce)(r)},O=(e,t)=>{var s,r;const o=null!==(s=e.gamertag.uniqueGamertag)&&void 0!==s?s:e.gamertag.legacyGamertag,n=null!==(r=t.gamertag.uniqueGamertag)&&void 0!==r?r:t.gamertag.legacyGamertag;return o.localeCompare(n,void 0,{sensitivity:"accent"})},A=(e,t)=>{var s,r,o,n;return(null===(s=e.presence)||void 0===s?void 0:s.presenceState)===(null===(r=t.presence)||void 0===r?void 0:r.presenceState)?0:"online"===(null===(o=e.presence)||void 0===o?void 0:o.presenceState)?-1:"online"===(null===(n=t.presence)||void 0===n?void 0:n.presenceState)?1:0},N=(e,t)=>{var s,r,o;return(null===(s=e.presence)||void 0===s?void 0:s.presenceIsGame)===(null===(r=t.presence)||void 0===r?void 0:r.presenceIsGame)?0:null!==(o=e.presence)&&void 0!==o&&o.presenceIsGame?-1:1},X=(e,t)=>e.isFavorite===t.isFavorite?0:e.isFavorite?-1:1,B=(e,t)=>((e,t,s)=>{for(const r of s){const s=r(e,t);if(0!==s)return s}return 0})(e,t,[A,X,N,O]),Q=e=>()=>{const{useSelector:t,useDispatch:s,useStore:r}=(0,o.useContext)(e),n=(0,u.n)("people",e),i=null===n||void 0===n?void 0:n.peopleSelectors,a=null===n||void 0===n?void 0:n.actions,l=(0,o.useCallback)((e=>i?i.getFriendsLCE(e):v.LCE_NOT_REQUESTED),[i]),c=null===a||void 0===a?void 0:a.getFriends.start(),[,d]=(0,w.r)(n,l,c,void 0,{useSelector:t,useDispatch:s,useStore:r}),p=(0,o.useMemo)((()=>(0,v.lceTransform)(d,(e=>e.sort(B)))),[d]);return(0,v.useLce)(p)};s(30163);const $=e=>{const t=D(e);return s=>{const{useSelector:r,useDispatch:n,useStore:i}=(0,o.useContext)(e),l=(0,u.n)("people",e),c=null===l||void 0===l?void 0:l.peopleSelectors,d=null===l||void 0===l?void 0:l.actions,p=(0,a.Jd)(),g=null===p||void 0===p?void 0:p.xuid,m=(0,o.useCallback)((e=>c&&s?c.getFriendsOfUserXuidsLCE(e,s):v.LCE_NOT_REQUESTED),[c,s]),f=(0,o.useMemo)((()=>s?null===d||void 0===d?void 0:d.getFriendsOfUser.start(s):void 0),[d,s]),S=n(),h=(0,o.useCallback)((()=>{f&&S(f)}),[S,f]),[C,E]=(0,w.r)(l,m,f,void 0,{useSelector:r,useDispatch:n,useStore:i}),[,F]=t(C),k=(0,o.useMemo)((()=>(0,v.lceTransform)((0,v.lceMerge)(E,F,{onlyRequireOneNotRequested:!0}),(([e,t])=>{if(!e||!t)return[];const r=s===g?t.filter((e=>e.isFriend)):t;return _(r,g)}))),[g,E,F,s]);return(0,v.useLce)(k,h)}},J=e=>t=>{const{useSelector:s,useDispatch:r,useStore:n}=(0,o.useContext)(e),i=(0,u.n)("people",e),a=null===i||void 0===i?void 0:i.peopleSelectors,l=(0,o.useCallback)((e=>t&&a?a.getFriendsWhoPlayLCE(e,t):v.LCE_NOT_REQUESTED),[a,t]),c=(0,o.useMemo)((()=>{if(i&&t)return i.actions.getFriendsWhoPlay.start(t)}),[i,t]);return(0,w.r)(i,l,c,void 0,{useSelector:s,useDispatch:r,useStore:n})};var W=s(41506),j=s.n(W);s(64727);const H=new r.Logger("useGameInviteFromLinkToken"),V=e=>()=>{const t=(0,u.n)("people",e);return(0,o.useCallback)((async e=>{if(t)try{const s=await t.fetchActivityFromLinkToken(e);return s.activityType===t.activityType.None?void H.error(`Link token no longer active: ${e}`):{rawNotification:JSON.stringify(j()(j()({},s),{},{notificationData:s.activityType===t.activityType.Mpa?j()(j()({},s.connectionData),{},{titleName:""}):{sender:s.gamertag,connectionString:"",activationInfo:s.inviteHandle.gameTypes,invitedUser:s.inviteHandle.senderXuid,titleName:s.inviteHandle.activityInfo.titleName}})),titleId:s.titleId,actor:{xuid:s.gamertag.xuid,gamertag:{legacyGamertag:s.gamertag.gamertag,base:s.gamertag.modernGamertag,suffix:s.gamertag.modernGamertagSuffix,uniqueGamertag:s.gamertag.uniqueModernGamertag}}}}catch(s){const t=(0,p.g)(s);return void H.error(`An unexpected error occurred when trying to redeem the link token ${e} for game invite`,t)}}),[t])},z=e=>t=>{const s=(0,u.n)("people",e),n=(0,r.useLogger)("useGenerateGamertags"),[i,a]=(0,o.useState)(v.LCE_NOT_REQUESTED);(0,o.useEffect)((()=>{a(v.LCE_NOT_REQUESTED)}),[t,a]);const l=(0,o.useCallback)((async()=>{s&&(a((0,v.lceFetching)()),s.gamertagService.generateGamertags(t).then((e=>{a((0,v.lceContent)(e))})).catch((e=>{const t=(0,p.g)(e);a((0,v.lceError)(t)),n.error("Failed to get generated gamertags: ",t)})))}),[s,n,t,a]),c=(0,o.useCallback)((()=>a(v.LCE_NOT_REQUESTED)),[a]),d=(0,v.useLce)(i);return(0,o.useMemo)((()=>[...d,{generateGamertag:l,clearGeneratedGamertags:c}]),[d,l,c])},K=new r.Logger("useGenerateOpenEndedInviteLinkToken"),Y=e=>t=>{const s=(0,u.n)("people",e),[r,n]=(0,o.useState)(v.LCE_NOT_REQUESTED);(0,o.useEffect)((()=>n(v.LCE_NOT_REQUESTED)),[t]);const i=(0,o.useCallback)((()=>{s&&t&&(n((0,v.lceFetching)()),s.fetchOpenEndedLinkTokenFromTitleId(t).then((e=>{n((0,v.lceContent)(e.linkToken))})).catch((e=>{const s=(0,p.g)(e);K.error(`An unexpected error occurred when trying to create a link token for titleId ${t}`,s),n((0,v.lceError)(s))})))}),[s,t]),a=(0,o.useCallback)((()=>n(v.LCE_NOT_REQUESTED)),[]),l=(0,v.useLce)(r);return(0,o.useMemo)((()=>[...l,{generateLinkToken:i,clearLinkToken:a}]),[l,i,a])};s(93510);const Z=e=>({code:Number(e.code),description:e.description}),ee=e=>()=>{const t=(0,u.n)("people",e),s=(0,r.useLogger)("useGetCanUserChangeGamertagForFree"),[n,i]=(0,o.useState)(v.LCE_NOT_REQUESTED);return(0,o.useEffect)((()=>{(async()=>{!t||(0,v.isFetching)(n)||(0,v.isContent)(n)||(0,v.isError)(n)||(i((0,v.lceFetching)()),t.gamertagService.getCanUserChangeGamertagForFree("","","").then((e=>{i((0,v.lceContent)({hasFree:e.hasFree,hasModernGamertag:e.hasModernGamertag,hasEntitlement:!0}))})).catch((async e=>{var t;if(!e||null!==(t=e.response)&&void 0!==t&&t.status){const t=await e.response.json(),{code:r,description:o}=Z(t);if(5025===r)i((0,v.lceContent)({hasFree:!1,hasModernGamertag:!0,hasEntitlement:!1}));else{const t=(0,p.g)(e);i((0,v.lceError)(t)),s.error("Failed to get the current gamertag status and entitlement: ",o||t)}}else{const t=(0,p.g)(e);i((0,v.lceError)(t)),s.error("Failed to get the current gamertag status and entitlement:",t)}})))})()}),[t,n,s]),(0,v.useLce)(n)},te=e=>()=>{const{useSelector:t}=(0,o.useContext)(e),s=(0,u.n)("people",e),r=null===s||void 0===s?void 0:s.peopleSelectors,n=(0,o.useCallback)((e=>r?r.getFriendRequestSummaryLCE(e):v.LCE_NOT_REQUESTED),[r]);return(0,v.useLce)(t(n))},se=e=>()=>{const{useDispatch:t}=(0,o.useContext)(e),s=(0,u.n)("people",e),r=(0,a.XI)(),n=t(),l=(0,o.useCallback)(((e,t)=>{s&&r&&n(s.actions.getPerson.start(e,t,["detail","multiplayerSummary","presenceDetail","preferredColor"]))}),[n,s,r]);return(0,i.I)(l,!!s)},re=e=>()=>{const{useSelector:t,useDispatch:s,useStore:r}=(0,o.useContext)(e),n=(0,u.n)("people",e),i=null===n||void 0===n?void 0:n.peopleSelectors,a=null===n||void 0===n?void 0:n.actions,l=(0,o.useCallback)((e=>i?i.getReceivedFriendRequestsLCE(e,n.decoration.Detail):v.LCE_NOT_REQUESTED),[null===n||void 0===n?void 0:n.decoration,i]),c=(0,o.useMemo)((()=>null===a||void 0===a?void 0:a.getReceivedFriendRequests.start()),[a]);return(0,w.r)(n,l,c,void 0,{useSelector:t,useDispatch:s,useStore:r})},oe=e=>()=>{const{useSelector:t,useDispatch:s,useStore:r}=(0,o.useContext)(e),n=(0,u.n)("people",e),i=null===n||void 0===n?void 0:n.peopleSelectors,a=null===n||void 0===n?void 0:n.actions,l=(0,o.useCallback)((e=>i?i.getSentFriendRequestsLCE(e):v.LCE_NOT_REQUESTED),[i]),c=(0,o.useMemo)((()=>null===a||void 0===a?void 0:a.getSentFriendRequests.start()),[a]);return(0,w.r)(n,l,c,void 0,{useSelector:t,useDispatch:s,useStore:r})};s(69375),s(75604),s(41532),s(32950),s(73599),s(64770),s(62080),s(97012),s(31274),s(29548),s(47342),s(14825),s(92467),s(67497),s(88236);var ne=s(47283),ie=s(79824),ae=s(87309),le=s(49578),ue=s(15387),ce=s(50906);const de=e=>()=>{const t=(0,u.n)("people",e),s=(0,ue.G_)(ae.H.EnableParties),r=(0,ie.useSelector)(ne.Kj),[,n]=Ze(r),[,i]=(0,le.J)(),a=(0,o.useMemo)((()=>(0,v.lceTransform)((0,v.lceMerge)(n,i,{onlyRequireOneNotRequested:!0}),(([e,r])=>{if(!r)return null;const{friendsInJoinableSessions:o,activeFriends:n}=r,i=new Map;if(!s)return{friendsInJoinableSessions:o,joinableParties:i,activeFriends:n};const a=(0,ce.x)(e);for(const s of o){var l;const e=(0,ce.x)(s),r=null===t||void 0===t?void 0:t.isUserInJoinableParty(null===(l=s.multiplayerSummary)||void 0===l?void 0:l.party,s.isFriend);e&&e!==a&&r&&(i.has(e)?i.get(e).push(s):i.set(e,[s]))}for(const s of n){var u;const e=(0,ce.x)(s),r=null===t||void 0===t?void 0:t.isUserInJoinableParty(null===(u=s.multiplayerSummary)||void 0===u?void 0:u.party,s.isFriend);e&&e!==a&&r&&(i.has(e)?i.get(e).push(s):i.set(e,[s]))}return{friendsInJoinableSessions:o,joinableParties:i,activeFriends:n}}))),[n,s,i,t]);return(0,v.useLce)(a)};var ve=s(94787),pe=s(78672);const ge=new r.Logger("useInviteUsersToGame"),me=e=>function(){const t=(0,u.n)("people",e),{trackUserAction:s}=(0,ve.o3)();return(0,o.useCallback)((async(e,r)=>{if(t)try{s(pe.a.SendGameInvite,void 0,{xuids:e,titleId:r}),await t.inviteUsersToGame(e,r)}catch(o){const t=(0,x.toError)(o);ge.error(`An unexpected error occurred when trying to invite users to the game (${r}): ${e}:${t}`)}else ge.info("people plugin is not loaded")}),[t,s])},fe=e=>(t,s)=>{const{useSelector:r,useDispatch:n,useStore:i}=(0,o.useContext)(e),l=(0,a.XI)(),c=(0,u.n)("people",e),d=(0,o.useMemo)((()=>{const e=["Presence","Detail","MultiplayerSummary"],t=s?[...e,...s]:e;let r=0;if(c)for(const s of t)switch(s){case"Presence":r|=c.decoration.Presence;break;case"PreferredColors":r|=c.decoration.PreferredColors;break;case"Detail":r|=null===c||void 0===c?void 0:c.decoration.Detail;break;case"Recommendation":r|=c.decoration.Recommendation;break;case"MultiplayerSummary":r|=c.decoration.MultiplayerSummary;break;case"RecentPlayer":r|=c.decoration.RecentPlayer}return r}),[s,c]),p=null===c||void 0===c?void 0:c.peopleSelectors,{getProfileLCE:g}=(0,o.useMemo)((()=>t&&p?p.makePersonSelectors(t):{getProfileLCE:()=>v.LCE_NOT_REQUESTED}),[t,p]),m=(0,o.useMemo)((()=>t&&c&&l?c.actions.getPerson.start(t):void 0),[t,c,l]);return(0,v.useLceWithConditions)((0,w.r)(c,(e=>g(e,d)),m,void 0,{useSelector:r,useDispatch:n,useStore:i}),{notRequested:!t})},Se=e=>t=>{var s;const r=(0,u.n)("people",e),o=fe(e),[n]=o(t);return!!n&&(null===r||void 0===r?void 0:r.isUserInJoinableParty(null===(s=n.multiplayerSummary)||void 0===s?void 0:s.party,n.isFriend))},he=e=>{const t=Q(e);return()=>{const s=(0,u.n)("people",e),[,r]=t(),n=(0,o.useMemo)((()=>(0,v.lceTransform)(r,(e=>s?e.filter((e=>{var t;return(null===(t=e.presence)||void 0===t?void 0:t.presenceState)!==s.presenceState.Online})):[]))),[r,s]);return(0,v.useLce)(n)}},Ce=e=>{const t=Q(e);return()=>{const s=(0,u.n)("people",e),[,r]=t(),n=(0,o.useMemo)((()=>(0,v.lceTransform)(r,(e=>s?e.filter((e=>{var t;return(null===(t=e.presence)||void 0===t?void 0:t.presenceState)===s.presenceState.Online})):[]))),[r,s]);return(0,v.useLce)(n)}},Ee=e=>{const t=fe(e);return e=>{const[,s]=t(e,["Detail"]),r=(0,o.useMemo)((()=>(0,v.lceTransform)(s,(e=>{var t,s;const r=null!==(t=null===(s=e.detail)||void 0===s?void 0:s.watermarks)&&void 0!==t?t:[],o=[];for(const n of r)o.push({imageUrl:Fe(n),id:n});return o}))),[s]);return(0,v.useLce)(r)}};function Fe(e,t="launch"){return`https://dlassets-ssl.xboxlive.com/public/content/ppl/watermarks/${t}/${e.toLowerCase()}.png`}const ke=e=>()=>{const{useSelector:t,useDispatch:s,useStore:r}=(0,o.useContext)(e),n=(0,u.n)("people",e),i=null===n||void 0===n?void 0:n.peopleSelectors,a=(0,o.useCallback)((e=>i?i.getRecentPlayersLCE(e):v.LCE_NOT_REQUESTED),[i]);return(0,w.r)(n,a,null===n||void 0===n?void 0:n.actions.getRecentPlayers.start(),void 0,{useSelector:t,useDispatch:s,useStore:r})},ye=new r.Logger("useRedeemFriendInviteLink"),Re=e=>()=>{const{useDispatch:t}=(0,o.useContext)(e),s=t(),r=(0,u.n)("people",e),n=(0,a.XI)(),l=(0,a.Jd)(),c=null===l||void 0===l?void 0:l.xuid,d=(0,o.useCallback)((async(e,t,o)=>{if(r&&n&&c)try{await r.socialService.redeemFriendLink(e,t),s(r.actions.getPerson.start(e,!0)),null===o||void 0===o||o(!0)}catch(i){const e=(0,p.g)(i);ye.error("Failed to redeem friend invite link",e),null===o||void 0===o||o(!1)}}),[c,s,n,r]);return(0,i.I)(d,!!r&&n)},Le=new r.Logger("useRemoveFollower"),Ue=e=>function(t){const{useDispatch:s}=(0,o.useContext)(e),r=(0,u.n)("people",e),n=s(),l=(0,a.Jd)(),c=null===l||void 0===l?void 0:l.xuid,d=(0,o.useCallback)((async()=>{if(r&&c)try{await r.socialService.removeFollower(t),n(r.actions.removeFollowerSucceeded(c,t)),n(r.actions.getPerson.start(c,!0))}catch(e){const t=(0,p.g)(e);Le.error(t.message)}}),[c,n,r,t]);return(0,i.I)(d,!!r&&!!c&&!!t)},xe=new r.Logger("useRemoveFriend"),Te=e=>function(t){const{useDispatch:s}=(0,o.useContext)(e),r=(0,u.n)("people",e),n=s(),l=(0,a.Jd)(),c=null===l||void 0===l?void 0:l.xuid,d=(0,o.useCallback)((async()=>{if(r&&c)try{await r.socialService.removeFriend(t),n(r.actions.removeFriendSucceeded(c,t)),n(r.actions.getPerson.start(c,!0))}catch(e){const t=(0,p.g)(e);xe.error(t.message)}}),[c,n,r,t]);return(0,i.I)(d,!!r&&!!c&&!!t)},be=e=>t=>{const s=(0,u.n)("people",e),{useDispatch:r}=(0,o.useContext)(e),n=r(),a=(0,o.useCallback)((()=>{s&&n(s.actions.removeRecommendation.start(t))}),[t,s,n]);return(0,i.I)(a,!!s)};s(98376),s(46929),s(47748),s(5350);var we=s(37509);var _e=s(93441);const Ie=e=>(t,s,n)=>{const i=(0,u.n)("people",e),a=(0,r.useLogger)("useReserveGamertag"),[l]=Ze(t),c=l?l.gamertag.base:void 0,d=null===l||void 0===l?void 0:l.gamertag.legacyGamertag,[g,m,f,S,h,C,E,F,k]=(0,_e.cG)("ChangeGamertag_Error_Classic_Gamertag_Conflict","ChangeGamertag_Error_Classic_Gamertag_Contains_Invalid_text","ChangeGamertag_Error_Starts_With_Invalid_Text","ChangeGamertag_Error_Not_Allowed_Text","ChangeGamertag_Error_Whitespaces_Text","ChangeGamertag_Error_Conflict_Text","ChangeGamertag_Error_Generic_Reserve_Text","ChangeGamertag_Error_Contains_Invalid_text","ChangeGamertag_Error_Already_Owned_Text"),[y,R]=(0,o.useState)(v.LCE_NOT_REQUESTED);(0,o.useEffect)((()=>{R(v.LCE_NOT_REQUESTED)}),[t,s,n]);const L=(0,o.useCallback)((async()=>{if(!i||!t||!n&&!s||!c||!d)return;const e=((e,t,s,r,o)=>{const{locErrorClassicGamertagContainsInvalidText:n,locErrorStartsWithInvalidText:i,locErrorWhitespacesText:a,locErrorContainsInvalidText:l,locErrorAlreadyOwnedGamertagText:u}=s;if((null===r||void 0===r?void 0:r.toLowerCase().trim())===(null===e||void 0===e?void 0:e.toLowerCase().trim())||(null===o||void 0===o?void 0:o.toLowerCase().trim())===(null===t||void 0===t?void 0:t.toLowerCase().trim()))return{isValid:!1,errorMessage:u};if(null!==r&&void 0!==r&&r.includes("  ")||null!==o&&void 0!==o&&o.includes("  "))return{isValid:!1,errorMessage:a};if(/^[^a-zA-Z]/.test(r||o||""))return{isValid:!1,errorMessage:i};const c=/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>\\/?]+/,d=r||o||"";if(c.test(d)){const e=[];if([...d].forEach((t=>{c.test(t)&&!e.includes(t)&&e.push(t)})),r)return{isValid:!1,errorMessage:(0,we.GPZ)(l,e.join(", "))};if(o)return{isValid:!1,errorMessage:n}}return{isValid:!0,errorMessage:""}})(c,d,{locErrorClassicGamertagContainsInvalidText:m,locErrorStartsWithInvalidText:f,locErrorWhitespacesText:h,locErrorContainsInvalidText:F,locErrorAlreadyOwnedGamertagText:k},n,s);e.isValid?(R((0,v.lceFetching)()),i.gamertagService.reserveGamertag(t,{modernGamertag:n,classicGamertag:s}).then((e=>{const t={gamertag:e.gamertag,modernGamertag:e.modernGamertag,modernGamertagSuffix:e.modernGamertagSuffix,uniqueModernGamertag:e.uniqueModernGamertag,classicTranslationLevel:e.classicTranslationLevel,promptForClassicGamertag:e.promptForClassicGamertag};R((0,v.lceContent)(t))})).catch((async e=>{let s="";if(e.response){const r=await e.response.json(),{code:o}=Z(r);switch(o){case 1001:s=g;break;case 1012:s=S;break;case 1037:s=C;break;default:s=E}R((0,v.lceError)(new Error(s))),a.error(`Failed to reserve gamertag for XUID: ${t} : ${s}`)}else{const s=(0,p.g)(e);a.error(`Failed to reserve gamertag for XUID: ${t} with status code: ${s.name} and message: ${s.message}`,s),R((0,v.lceError)(s))}}))):R((0,v.lceError)(new Error(e.errorMessage)))}),[i,t,n,s,c,d,k,g,m,f,S,h,C,E,F,a]),U=(0,v.useLce)(y);return(0,o.useMemo)((()=>[...U,{reserveGamertag:L}]),[U,L])},Pe=new r.Logger("useRevokeLinkToken"),De=e=>function(){const t=(0,u.n)("people",e);return(0,o.useCallback)((async e=>{if(!t)return Pe.info("people plugin is not loaded"),!1;if(!e)return Pe.info("no link token to revoke"),!1;try{return await t.revokeOpenEndedLink(e),!0}catch(s){const t=(0,p.g)(s);return Pe.error(`An unexpected error occurred when trying to revoke the link token ${e}`,t),!1}}),[t])},Me=new r.Logger("useSendRequest"),Ge=e=>(t,s,r)=>{const{useDispatch:c}=(0,o.useContext)(e),d=c(),v=(0,u.n)("people",e),p=(0,u.n)("trust",e),g=(0,a.Jd)(),m=null===g||void 0===g?void 0:g.xuid,[f]=(0,l.zY)(),[S]=Ze(t),h=(0,o.useCallback)((async e=>{if(v&&m)if(S&&S.detail&&!S.detail.canBeFriended)d(v.customPeopleActions.allowFriendInvitesBlocked());else try{Me.info(`ramah - sending friend request to ${t}`),await v.socialService.sendFriendRequest(m,t,e),d(v.actions.sendFriendRequestSucceeded(t)),null===s||void 0===s||s()}catch(o){const e=v.customPeopleActions.genericPeopleError();if(o instanceof v.socialServiceError)if(p&&o.code===v.socialServiceErrorCode.ParentalControlCheckFailed&&f)try{d(p.actions.displayAddFriendModal(m,t,n.p.Send))}catch(i){d(e)}else o.code===v.socialServiceErrorCode.FriendRequestPrivacyFail?d(v.customPeopleActions.allowFriendInvitesBlocked()):o.code===v.socialServiceErrorCode.PeopleListFull||o.code===v.socialServiceErrorCode.FriendsModifyErrorListFull||o.code===v.socialServiceErrorCode.FriendsModifyErrorOtherListFull?d(v.customPeopleActions.requestInboxFull()):d(e);else d(e);null===r||void 0===r||r()}}),[m,d,f,r,s,v,S,t,p]);return(0,i.I)(h,!!v&&!!m)},qe=e=>function(t){const{useDispatch:s}=(0,o.useContext)(e),r=(0,u.n)("people",e),n=s(),l=(0,a.Jd)(),c=null===l||void 0===l?void 0:l.xuid,d=(0,o.useCallback)((async()=>{if(r&&c)try{await r.socialService.shareRealNameWithUser(c,t),n(r.actions.shareRealNameWithUser.success(t))}catch(e){const s=(0,p.g)(e);n(r.actions.shareRealNameWithUser.error(r.actions.shareRealNameWithUser.start(c,t),s))}}),[c,n,r,t]);return(0,i.I)(d,!!r&&!!c)},Oe=e=>()=>{const{useSelector:t,useDispatch:s,useStore:r}=(0,o.useContext)(e),n=(0,u.n)("people",e),i=null===n||void 0===n?void 0:n.peopleSelectors,a=null===n||void 0===n?void 0:n.decoration,l=(0,o.useCallback)((e=>i&&a?i.getSuggestedFriendsLCE(e,a.Detail):v.LCE_NOT_REQUESTED),[i,a]);return(0,w.r)(n,l,null===n||void 0===n?void 0:n.actions.getRecommendations.start(["detail"]),void 0,{useSelector:t,useDispatch:s,useStore:r})},Ae=e=>function(t){const{useDispatch:s}=(0,o.useContext)(e),r=(0,u.n)("people",e),n=s(),l=(0,a.Jd)(),c=null===l||void 0===l?void 0:l.xuid,d=(0,o.useCallback)((async()=>{if(r&&c)try{await r.socialService.unfollowUser(c,t),n(r.actions.unfollowUserSucceeded(t)),n(r.actions.getPerson.start(c,!0))}catch(e){const s=r.customPeopleActions.unfollowUserFailed(c,t);n(s)}}),[c,n,r,t]);return(0,i.I)(d,!!r&&!!c&&!!t)},Ne=e=>function(t){const{useDispatch:s}=(0,o.useContext)(e),r=(0,u.n)("people",e),n=s(),l=(0,a.Jd)(),c=null===l||void 0===l?void 0:l.xuid,d=(0,o.useCallback)((async()=>{if(r&&c)try{await r.socialService.unshareRealNameWithUser(c,t),n(r.actions.unshareRealNameWithUser.success(t))}catch(e){const s=(0,p.g)(e);n(r.actions.unshareRealNameWithUser.error(r.actions.unshareRealNameWithUser.start(c,t),s))}}),[c,n,r,t]);return(0,i.I)(d,!!r&&!!c)},Xe=new r.Logger("useUserBlockState"),Be=e=>function(t){var s,r;const{useDispatch:n}=(0,o.useContext)(e),i=(0,u.n)("people",e),[a,{loading:l}]=Ze(t),c=n(),[d,g]=(0,o.useState)(null),[m,f]=(0,o.useState)(!1),S=(0,o.useCallback)((()=>{l||i&&t&&c(i.actions.getPerson.start(t,!0,["detail"]))}),[t,c,i,l]),h=(0,o.useCallback)((async e=>{var s;if(void 0===(null===a||void 0===a||null===(s=a.detail)||void 0===s?void 0:s.isBlocked)||!t||!i){var r;const e=[];return void 0===(null===a||void 0===a||null===(r=a.detail)||void 0===r?void 0:r.isBlocked)&&e.push("existing isBlocked state is undefined"),i||e.push("people plugin is not loaded"),t||e.push("no xuid is provided"),void Xe.info(`Cannot set blocked state: ${e.join(", ")}`)}g(e),f(!0);try{e?await i.privacyService.blockUser(t):await i.privacyService.unblockUser(t),c(i.actions.setUserBlockState.success(t,e))}catch(o){const s=(0,p.g)(o);c(i.actions.setUserBlockState.error(i.actions.setUserBlockState.start(t,e),s))}g(null),f(!1)}),[null===a||void 0===a||null===(s=a.detail)||void 0===s?void 0:s.isBlocked,t,i,c]),C=(0,o.useCallback)((()=>h(!0)),[h]),E=(0,o.useCallback)((()=>h(!1)),[h]),F=(0,o.useMemo)((()=>{var e;return m?(0,v.lceFetching)((0,v.lceContent)(d)):void 0===(null===a||void 0===a||null===(e=a.detail)||void 0===e?void 0:e.isBlocked)?v.LCE_NOT_REQUESTED:(0,v.lceContent)(a.detail.isBlocked)}),[m,d,null===a||void 0===a||null===(r=a.detail)||void 0===r?void 0:r.isBlocked]),k=(0,v.useLce)(F);return(0,o.useMemo)((()=>[...k,{blockUser:C,unblockUser:E,startRefreshUserBlockState:S}]),[k,C,E,S])},Qe=new r.Logger("useUserCloakedState"),$e=e=>function(t){const{useDispatch:s}=(0,o.useContext)(e),r=(0,u.n)("people",e),[n,{loading:i}]=Ze(t),a=s(),[l,c]=(0,o.useState)(null),[d,g]=(0,o.useState)(!1),m=(0,o.useCallback)((()=>{i||r&&t&&a(r.actions.getPerson.start(t,!0))}),[t,a,r,i]),f=(0,o.useCallback)((async e=>{if(void 0===(null===n||void 0===n?void 0:n.isCloaked)||!t||!r){const e=[];return void 0===(null===n||void 0===n?void 0:n.isCloaked)&&e.push("existing isCloaked state is undefined"),r||e.push("people plugin is not loaded"),t||e.push("no xuid is provided"),void Qe.info(`Cannot set cloak state: ${e.join(", ")}`)}c(e),g(!0);try{e?await r.presenceService.cloakUserPresence(t):await r.presenceService.uncloakUserPresence(t),a(r.actions.setCurrentUserCloakState.success(t,e))}catch(s){const t=(0,p.g)(s);a(r.actions.setCurrentUserCloakState.error(r.actions.setCurrentUserCloakState.start(e),t))}c(null),g(!1)}),[a,null===n||void 0===n?void 0:n.isCloaked,r,t]),S=(0,o.useCallback)((()=>f(!0)),[f]),h=(0,o.useCallback)((()=>f(!1)),[f]),C=(0,o.useMemo)((()=>d?(0,v.lceFetching)((0,v.lceContent)(l)):void 0===(null===n||void 0===n?void 0:n.isCloaked)?v.LCE_NOT_REQUESTED:(0,v.lceContent)(null===n||void 0===n?void 0:n.isCloaked)),[d,l,null===n||void 0===n?void 0:n.isCloaked]),E=(0,v.useLce)(C);return(0,o.useMemo)((()=>[...E,{cloakUser:S,uncloakUser:h,startRefreshCloak:m}]),[E,S,h,m])},Je=new r.Logger("useUserFavoriteState"),We=e=>function(t){const{useDispatch:s}=(0,o.useContext)(e),r=(0,u.n)("people",e),[n,{loading:i}]=Ze(t),l=s(),[c,d]=(0,o.useState)(null),[g,m]=(0,o.useState)(!1),f=(0,a.Jd)(),S=null===f||void 0===f?void 0:f.xuid,h=(0,o.useCallback)((()=>{i||r&&t&&l(r.actions.getPerson.start(t,!0))}),[t,l,r,i]),C=(0,o.useCallback)((async e=>{if(void 0===(null===n||void 0===n?void 0:n.isFavorite)||!r||!t||!S){const e=[];return void 0===(null===n||void 0===n?void 0:n.isFavorite)&&e.push("existing isFavorite state is undefined"),r||e.push("people plugin is not loaded"),t||e.push("no xuid is provided"),S||e.push("cannot fetch current user's xuid"),void Je.info(`Cannot set favorite state: ${e.join(", ")}`)}d(e),m(!0);try{e?(await r.socialService.favoriteUser(S,t),l(r.actions.favoriteUser.success(t))):(await r.socialService.unfavoriteUser(S,t),l(r.actions.unfavoriteUser.success(t)))}catch(s){const o=(0,p.g)(s);l(e?r.actions.favoriteUser.error(r.actions.favoriteUser.start(S,t),o):r.actions.unfavoriteUser.error(r.actions.unfavoriteUser.start(S,t),o))}d(null),m(!1)}),[null===n||void 0===n?void 0:n.isFavorite,t,S,r,l]),E=(0,o.useCallback)((()=>C(!0)),[C]),F=(0,o.useCallback)((()=>C(!1)),[C]),k=(0,o.useMemo)((()=>g?(0,v.lceFetching)((0,v.lceContent)(c)):void 0===(null===n||void 0===n?void 0:n.isFavorite)?v.LCE_NOT_REQUESTED:(0,v.lceContent)(n.isFavorite)),[g,c,null===n||void 0===n?void 0:n.isFavorite]),y=(0,v.useLce)(k);return(0,o.useMemo)((()=>[...y,{favoriteUser:E,unfavoriteUser:F,startRefreshUserFavoriteState:h}]),[y,E,F,h])},je=new r.Logger("useUserMuteState"),He=e=>function(t){var s,r;const{useDispatch:n}=(0,o.useContext)(e),i=(0,u.n)("people",e),[a,{loading:l}]=Ze(t),c=n(),[d,g]=(0,o.useState)(null),[m,f]=(0,o.useState)(!1),S=(0,o.useCallback)((()=>{l||i&&t&&c(i.actions.getPerson.start(t,!0,["detail"]))}),[t,c,i,l]),h=(0,o.useCallback)((async e=>{var s;if(void 0===(null===a||void 0===a||null===(s=a.detail)||void 0===s?void 0:s.isMuted)||!t||!i){var r;const e=[];return void 0===(null===a||void 0===a||null===(r=a.detail)||void 0===r?void 0:r.isMuted)&&e.push("existing isMuted state is undefined"),t||e.push("no xuid is provided"),i||e.push("people plugin is not loaded"),void je.info(`Cannot set mute state: ${e.join(", ")}`)}g(e),f(!0);try{e?await i.privacyService.muteUser(t):await i.privacyService.unmuteUser(t),c(i.actions.setUserMuteState.success(t,e))}catch(o){const s=(0,p.g)(o);c(i.actions.setUserMuteState.error(i.actions.setUserMuteState.start(t,e),s))}g(null),f(!1)}),[null===a||void 0===a||null===(s=a.detail)||void 0===s?void 0:s.isMuted,t,i,c]),C=(0,o.useCallback)((()=>h(!0)),[h]),E=(0,o.useCallback)((()=>h(!1)),[h]),F=(0,o.useMemo)((()=>{var e;return m?(0,v.lceFetching)((0,v.lceContent)(d)):void 0===(null===a||void 0===a||null===(e=a.detail)||void 0===e?void 0:e.isMuted)?v.LCE_NOT_REQUESTED:(0,v.lceContent)(a.detail.isMuted)}),[m,d,null===a||void 0===a||null===(r=a.detail)||void 0===r?void 0:r.isMuted]),k=(0,v.useLce)(F);return(0,o.useMemo)((()=>[...k,{muteUser:C,unmuteUser:E,startRefreshUserMuteState:S}]),[k,C,E,S])},Ve=new r.Logger("useUserProfileSettings"),ze=e=>function(t){const{useDispatch:s}=(0,o.useContext)(e),r=(0,u.n)("people",e),[n,{loading:i}]=Ze(t),a=s(),[l,c]=(0,o.useState)(null),[d,g]=(0,o.useState)(!1),m=(0,o.useCallback)((()=>{i||r&&t&&a(r.actions.getPerson.start(t,!0,["detail"]))}),[t,a,r,i]),f=(0,o.useCallback)((async e=>{if(null===n||void 0===n||!n.detail||!t||!r){const e=[];return null!==n&&void 0!==n&&n.detail||e.push("existing user profile settings are undefined"),t||e.push("no xuid is provided"),r||e.push("people plugin is not loaded"),void Ve.info(`Cannot set user profile settings: ${e.join(", ")}`)}c(e),g(!0);try{await r.profileService.setProfileSettings(e),a(r.actions.updateProfileSettings.success(t,e)),a(r.actions.getPerson.start(t,!0))}catch(s){const t=(0,p.g)(s);a(r.actions.updateProfileSettings.error(r.actions.updateProfileSettings.start(e),t))}c(null),g(!1)}),[a,r,null===n||void 0===n?void 0:n.detail,t]),S=(0,o.useCallback)((e=>f(e)),[f]),h=(0,o.useMemo)((()=>d?(0,v.lceFetching)((0,v.lceContent)(l)):void 0===(null===n||void 0===n?void 0:n.detail)?v.LCE_NOT_REQUESTED:(0,v.lceContent)({Bio:n.detail.bio,Location:n.detail.location})),[d,l,null===n||void 0===n?void 0:n.detail]),C=(0,v.useLce)(h);return(0,o.useMemo)((()=>[...C,{onSetUserProfileSettings:S,startRefreshUserProfileSettings:m}]),[C,S,m])},Ke=e=>t=>{const{useSelector:s,useDispatch:r,useStore:n}=(0,o.useContext)(e),i=(0,u.n)("people",e),a=null===i||void 0===i?void 0:i.peopleSelectors,l=(0,o.useCallback)((e=>t&&a?a.getXuidForGamertagLCE(e,t):(0,v.lceNotRequested)()),[a,t]),c=(0,o.useMemo)((()=>t?null===i||void 0===i?void 0:i.actions.getXuidForGamertag.start(t):void 0),[i,t]);return(0,v.useLceWithConditions)((0,w.r)(i,l,c,void 0,{useSelector:s,useDispatch:r,useStore:n}),{notRequested:!t})};var Ye=s(20418);const{usePerson:Ze,usePeople:et,useXuidForGamertag:tt,useFriends:st,useOnlineFriends:rt,useOfflineFriends:ot,useSuggestedFriends:nt,useRemoveRecommendation:it,useUserCloakedState:at,useUserMuteState:lt,useUserBlockState:ut,useUserFavoriteState:ct,useFriendsOfUser:dt,useFollowingOfUser:vt,useFriendsWhoPlay:pt,useFollowers:gt,useFollowUser:mt,useRemoveFollower:ft,useRemoveFriend:St,useUnfollowUser:ht,useFindJoinableSessionFromXuid:Ct,useRecentlyPlayedWithUsers:Et,useUserProfileSettings:Ft,useProfileBadges:kt,useInviteUsersToGame:yt,useGenerateOpenEndedInviteLinkToken:Rt,useGameInviteFromLinkToken:Lt,useActiveLinkTokens:Ut,useRevokeOpenEndedInviteLinkToken:xt,useRedeemFriendInviteLink:Tt,useFriendInviteLinkPreview:bt,useGetPerson:wt,useGetReceivedFriendRequestsLCE:_t,useGetFriendRequestSummaryLCE:It,useGetSentFriendRequestsLCE:Pt,useAcceptFriendRequest:Dt,useDeclineFriendRequest:Mt,useCancelFriendRequest:Gt,useSendFriendRequest:qt,useBatchAcceptFriendRequests:Ot,useBatchCancelFriendRequests:At,useBatchDeclineFriendRequests:Nt,useIsUserInJoinableParty:Xt,useGroupFriendsAndPartiesLCE:Bt,useShareRealNameWithUser:Qt,useUnshareRealNameWithUser:$t,useGenerateGamertags:Jt,useReserveGamertag:Wt,useCommitNewGamertag:jt,useGetCanUserChangeGamertagForFree:Ht}=(Vt=Ye.Ie,{usePerson:fe(Vt),usePeople:D(Vt),useXuidForGamertag:Ke(Vt),useFriends:Q(Vt),useOnlineFriends:Ce(Vt),useOfflineFriends:he(Vt),useSuggestedFriends:Oe(Vt),useRemoveRecommendation:be(Vt),useUserCloakedState:$e(Vt),useUserMuteState:He(Vt),useUserBlockState:Be(Vt),useUserFavoriteState:We(Vt),useFriendsOfUser:$(Vt),useFollowingOfUser:M(Vt),useFriendsWhoPlay:J(Vt),useFollowers:I(Vt),useFindJoinableSessionFromXuid:b(Vt),useRecentlyPlayedWithUsers:ke(Vt),useUserProfileSettings:ze(Vt),useProfileBadges:Ee(Vt),useInviteUsersToGame:me(Vt),useGenerateOpenEndedInviteLinkToken:Y(Vt),useGameInviteFromLinkToken:V(Vt),useActiveLinkTokens:m(Vt),useRevokeOpenEndedInviteLinkToken:De(Vt),useRedeemFriendInviteLink:Re(Vt),useFriendInviteLinkPreview:q(Vt),useGetPerson:se(Vt),useGetReceivedFriendRequestsLCE:re(Vt),useGetFriendRequestSummaryLCE:te(Vt),useGetSentFriendRequestsLCE:oe(Vt),useAcceptFriendRequest:d(Vt),useDeclineFriendRequest:U(Vt),useCancelFriendRequest:y(Vt),useSendFriendRequest:Ge(Vt),useIsUserInJoinableParty:Se(Vt),useGroupFriendsAndPartiesLCE:de(Vt),useUnfollowUser:Ae(Vt),useFollowUser:G(Vt),useRemoveFriend:Te(Vt),useRemoveFollower:Ue(Vt),useBatchAcceptFriendRequests:S(Vt),useBatchCancelFriendRequests:C(Vt),useBatchDeclineFriendRequests:F(Vt),useShareRealNameWithUser:qe(Vt),useUnshareRealNameWithUser:Ne(Vt),useGenerateGamertags:z(Vt),useReserveGamertag:Ie(Vt),useCommitNewGamertag:R(Vt),useGetCanUserChangeGamertagForFree:ee(Vt)});var Vt},34721:(e,t,s)=>{s.d(t,{y:()=>a,r:()=>i});var r=s(57361),o=s(55688),n=s(3093);function i(e,t,s,i,a){const l=function(e){return(0,n.useEventListener)(null===e||void 0===e?void 0:e.signInActionEventListener,o.CommonActionType.UserSignedIn),(0,n.useEventListener)(null===e||void 0===e?void 0:e.signInActionEventListener,o.CommonActionType.UserSignedOut),null===e||void 0===e?void 0:e.hasConsumedSignInAction}(e),u=(0,r.useReduxLce)(t,l?s:void 0,i,a);return(0,r.useLceWithConditions)(u,{fetching:!e})}function a(e,t,s,o,n,i){return(0,r.useMultipleReduxLces)(t,null!==e&&void 0!==e&&e.hasConsumedSignInAction?s:void 0,o,n,i)}},38132:(e,t,s)=>{s.d(t,{I:()=>u});s(47010);var r=s(66957),o=s(7463),n=s(14041),i=s(14154);const a=!1;function l(e,t){const s=(0,n.useRef)(),a=(0,n.useRef)();return e===s.current&&a.current||(s.current=e,a.current=e()),function(e,t=!1){const s=(0,i.X)((()=>new r.Logger("usePromise"))),[a,l]=(0,n.useState)(),u=(0,o.useIsMountedRef)(),c=(0,n.useRef)();return(0,n.useEffect)((()=>{t||c.current!==e&&(c.current=e,e.then((function(t){u.current&&c.current===e&&l((()=>t))})).catch((t=>{var r,o,n;c.current!==e?null===(o=s.current)||void 0===o||o.warn(`Unhandled exception from a previous Promise: ${t.message}`,t):null===(n=s.current)||void 0===n||n.error(`Unhandled Promise exception: ${t.message}`,t),null===(r=s.current)||void 0===r||r.debug("Promises should have their rejections handled prior to being passed into 'usePromise'")})))}),[u,s,e,t]),a}(a.current,t)}function u(e,t){if(!a)return l(e,t)}},49578:(e,t,s)=>{s.d(t,{J:()=>m});var r=s(41506),o=s.n(r),n=(s(69375),s(81045),s(5350),s(75604),s(41532),s(32950),s(73599),s(64770),s(62080),s(97012),s(31274),s(29548),s(47342),s(14825),s(92467),s(67497),s(88236),s(47010),s(57361)),i=s(14041),a=s(13312),l=s(87309),u=s(99412),c=s(9718),d=s(26341),v=s(15387),p=s(24013),g=s(79094);const m=e=>{const[t,s]=(0,d.OC)(),r=(0,v.G_)(l.H.IsTakehomeUser),m=(0,a.R)(t),[f,S]=(0,g.$)(m),h=(0,i.useMemo)((()=>{const e=[];for(const t in f){const s=f[t];s&&e.push(s)}return e}),[f]),[,C]=(0,p.I)(h);return(0,n.useLce)((0,i.useMemo)((()=>{const t=(0,n.lceMerge)(s,(0,n.lceMerge)(S,C,{onlyRequireOneNotRequested:!e}),{onlyRequireOneNotRequested:!0});return(0,n.lceTransform)(t,(([t,[s,n]])=>{const i=[],a=[];if(!t||!s||!e&&!n)return{friendsInJoinableSessions:i,activeFriends:a};const l=new Map;null===n||void 0===n||n.forEach((e=>{l.set(e.productId,e)}));for(const v of t){const{productId:t,xboxTitleId:n}=(0,c.a)(v,s),p=t&&l.get(t);if(t&&n&&p&&(0,u.VZ)(p,r)){if(e&&e!==n)continue;i.push(o()(o()({},v),{},{productId:t,xboxTitleId:n}))}else{var d;if(e&&e!==(null===(d=v.presence)||void 0===d?void 0:d.presenceTitleId))continue;a.push(v)}}return{friendsInJoinableSessions:i,activeFriends:a}}))}),[e,s,C,S,r]))}},50906:(e,t,s)=>{s.d(t,{x:()=>o});var r=s(1033);const o=e=>{var t,s;if(null!==e&&void 0!==e&&null!==(t=e.multiplayerSummary)&&void 0!==t&&t.party&&(null===e||void 0===e||null===(s=e.presence)||void 0===s?void 0:s.presenceState)===r.H.Online){return e.multiplayerSummary.party.sessionRef.name}}},69617:(e,t,s)=>{s.d(t,{XI:()=>l,Jd:()=>u});var r=s(14041),o=s(84719);const n=e=>()=>{const{useSelector:t}=(0,r.useContext)(e),s=(0,o.n)("auth",e);return"authenticated"===t((0,r.useMemo)((()=>s?s.authSelectors.getAuthStatus:()=>"unknown"),[s]))},i=e=>()=>{const{useSelector:t}=(0,r.useContext)(e),s=(0,o.n)("auth",e);return t((0,r.useMemo)((()=>s?s.authSelectors.getUser:()=>null),[s]))};var a=s(20418);const{useIsAuthenticated:l,useUser:u}=(c=a.Ie,{useIsAuthenticated:n(c),useUser:i(c)});var c},72841:(e,t,s)=>{s.d(t,{zY:()=>m});s(69375);var r=s(57361),o=s(66957),n=s(14041),i=s(69617),a=s(34721),l=s(84719);const u=new o.Logger("useGetIsManagedUser"),c=e=>()=>{const{useSelector:t,useDispatch:s,useStore:o}=(0,n.useContext)(e),c=(0,l.n)("family",e),d=null===c||void 0===c?void 0:c.familySelectors,v=null===c||void 0===c?void 0:c.actions,p=(0,i.Jd)(),g=null===p||void 0===p?void 0:p.xuid,m=(0,n.useCallback)((e=>d?d.getCurrentIsManagedUserStateLCE(e):r.LCE_NOT_REQUESTED),[d]),f=(0,n.useMemo)((()=>{if(!g||!v){const e=[];return g||e.push("xuid is undefined"),v||e.push("family plugin is not loaded"),void u.warn(`Cannot set family state: ${e.join(", ")}`)}return null===v||void 0===v?void 0:v.fetchUserFamily.start(g)}),[v,g]);return(0,a.r)(c,m,f,void 0,{useSelector:t,useDispatch:s,useStore:o})},d=new o.Logger("useFamilyState"),v=e=>()=>{const{useSelector:t,useDispatch:s,useStore:o}=(0,n.useContext)(e),u=(0,l.n)("family",e),c=null===u||void 0===u?void 0:u.familySelectors,v=null===u||void 0===u?void 0:u.actions,p=(0,i.Jd)(),g=null===p||void 0===p?void 0:p.xuid,m=(0,n.useCallback)((e=>c?c.getCurrentXuidFamilyInfoStateLCE(e):r.LCE_NOT_REQUESTED),[c]),f=(0,n.useMemo)((()=>{if(!g||!v){const e=[];return g||e.push("xuid is undefined"),v||e.push("family plugin is not loaded"),void d.warn(`Cannot set family state: ${e.join(", ")}`)}return null===v||void 0===v?void 0:v.fetchUserFamily.start(g)}),[v,g]);return(0,a.r)(u,m,f,void 0,{useSelector:t,useDispatch:s,useStore:o})};var p=s(20418);const{useUserFamilyInfoState:g,useIsManagedUserState:m}=(f=p.Ie,{useUserFamilyInfoState:v(f),useIsManagedUserState:c(f)});var f},84719:(e,t,s)=>{s.d(t,{n:()=>i});var r=s(14041),o=s(38132),n=s(20418);const i=(e,t=n.Ie)=>{const{client:s}=(0,r.useContext)(t),i=s.addOrGetPlugin(e),a=(0,o.I)((0,r.useCallback)((()=>i.promise),[i.promise]),null!=i.plugin);return null!==a&&void 0!==a?a:i.plugin}},84777:(e,t,s)=>{var r;s.d(t,{p:()=>r}),function(e){e[e.Send=0]="Send",e[e.Accept=1]="Accept"}(r||(r={}))}}]);